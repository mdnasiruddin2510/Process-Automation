@model IEnumerable<App.Domain.ViewModel.SalePreviewVM>
@{
    ViewBag.Title = "SaleChallanPdf";
    Layout = null;
    decimal TotQty = 0;
    decimal TotAmt = 0;
    decimal TotDiscount = 0;
    decimal AmtPayable = 0;
    string custC = "Customer Copy";
    string offC = "Office Copy";
    string godownC = "Godown Copy";
    string CopyLabel = "";
    int sl = 0;
    int count = 0;
    var mItem = Model.FirstOrDefault();
    var signatory = ViewBag.signatory;
    int sCount = signatory.Count;
    var cAdd = ViewBag.CAdd;
    var cEmail = ViewBag.CEmails;
    var cMob = ViewBag.CPhones;
    var CompInfo = TopUp17Web.Models.GetCompanyInfo.GetComInfo();
    string CompanyAddress = ((CompInfo.Addr1 == null ? string.Empty : CompInfo.Addr1) + (CompInfo.Addr2 == null ? string.Empty : CompInfo.Addr2));
}
<script src="~/Scripts/jquery-1.9.1.min.js"></script>
<script src="~/Scripts/Export.js"></script>
<link href="~/App_Themes/Theme1/plugins/datatables/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
<link href="~/App_Themes/Theme1/plugins/bootstrap-daterangepicker/daterangepicker.css" rel="stylesheet">
<link href="~/App_Themes/Theme1/plugins/datatables/jquery.dataTables.min.css" rel="stylesheet" type="text/css" />
<link href="~/App_Themes/Theme1/plugins/select2/select2.css" rel="stylesheet" type="text/css" />
<link href="~/Css/FormDesign.css" rel="stylesheet" />

<style>
    hr {
        background-color: black;
        /*height: 0.5px;*/
    }

    tr {
        page-break-inside: avoid;
    }

    body {
        padding-right: 0px;
        /*font-weight: bold;*/
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
    }

    .myinput[type="checkbox"]:before {
        position: relative;
        display: block;
        width: 15px;
        height: 15px;
        border: 1px solid black;
        content: "";
        background: #FFF;
    }

    .border {
        color: #335; /* Lighten up font color */
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        font-weight: 300;
        border-collapse: collapse;
        border-spacing: 0;
    }

    .tds {
        /*border: 1px solid black;*/
        font-weight: 500;
        font-family: Arial;
        border-right: hidden !important;
    }
    /* Make cells a bit taller */
    .ths {
        /*border: 1px solid black;*/
        font-weight: 500;
        font-family: Arial;
    }

    .th {
        background: #F3F3F3; /* Light grey background */
        font-weight: bold; /* Make sure they're bold */
    }

    .td {
        background: #FAFAFA; /* Lighter grey background */
        text-align: center; /* Center our text */
    }

    .breakhere {
        page-break-after: always;
    }
</style>


@if (ViewBag.CopyType == 3) //for Challan
{
    for (int i = 0; i < ViewBag.CopyQty; i++)
    {
        sl = 0; TotQty = 0; count = 0;
        if (i == 0) { CopyLabel = custC; }
        else if (i == 1) { CopyLabel = offC; }
        else { CopyLabel = godownC; }

        <div id="toReport" class="panel-body" style="margin: auto; text-align:center !important; width:800px; height:1200px; padding:60px">
            <div class="panel-title" style="text-align:right">
                <text style="text-align:right !important; text-decoration: none; font-size:15px; border:2px solid black ; padding:5px">@CopyLabel</text>
            </div>
            <div class="panel-heading" style="text-align:center">
                <div class="panel-title">
                    <label style="text-align:center !important; text-decoration: none; font-size:25px; font-weight:bold">@CompInfo.CompName</label><br>
                    <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Office: @CompanyAddress</label><br>
                    <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Phone: @CompInfo.Tel</label><br>
                    <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Email: @CompInfo.Email</label>
                </div>
                <br>
                <br>
                <div class="panel-title">
                    <text style="text-align:center !important; text-decoration: none; font-size:20px; border:1px solid black ; padding:5px">DELIVERY CHALLAN</text>
                </div>
                <br />
                <br />
            </div>
            <div class="row">
                <div class="col-md-6" style="float:left; text-align:left ;width: 550px">
                    <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                        <tbody id="tbodyId">
                            <tr>
                                <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@mItem.CustName</label></td>
                            </tr>
                            <tr>
                                <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Address</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SubAddress}</label></td>
                            </tr>
                            <tr>
                                <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer Code</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.CustCode}</label></td>
                            </tr>
                        </tbody>
                    </table>&ensp;
                </div>
                <div class="col-md-6" style="float:right;width:250px">
                    <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                        <tbody id="tbodyId">
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Challan No</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.IssueNo}</label></td>
                            </tr>
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Challan Date</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@Convert.ToDateTime(mItem.IssueDate).ToShortDateString()}</label></td>
                            </tr>
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Location</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.LocCode}</label></td>
                            </tr>
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice No</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                            </tr>
                            <tr>
                                <td style="text-align:left; font-size:12px; border: hidden !important"><label>Invoice Date</label></td>
                            </tr>
                        </tbody>
                    </table>&ensp;
                </div>
            </div>

            <div class="panel-body" style="text-align:center;">
                <table cellpadding="5" cellspacing="1" border=1 frame=box rules=all style="width:800px">
                    <thead style="height:300px">
                        <tr>
                            <th class="ths" style="font-size:15px; text-align:center">SL</th>
                            <th class="ths" style="font-size:15px; text-align:center">Code</th>
                            <th class="ths" style="font-size:15px; text-align:center">Item Name</th>
                            <th class="ths" style="font-size:15px; text-align:center">Quantity</th>
                        </tr>
                    </thead>
                    <tbody id="tbodyId">

                        @foreach (var item in Model)
                        {
                            sl += 1;
                        <tr>
                            <td class="" style="text-align:center; font-size:12px">
                                @Html.DisplayFor(modelItem => sl)
                            </td>
                            <td class="" style="text-align:center; font-size:12px">
                                @Html.DisplayFor(modelItem => item.ItemCode)
                            </td>
                            <td class="" style="text-align:left; font-size:12px">
                                @Html.DisplayFor(modelItem => item.ItemName)
                            </td>
                            <td style="text-align:right; font-size:12px;">
                                @Html.DisplayFor(modelItem => item.Qty)
                            </td>
                        </tr>
                            TotQty += Convert.ToDecimal(item.Qty);
                        }
                        <tr>
                            <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                            <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                            <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Total :</td>
                            <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotQty</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div style="float:left">
                <label style="font-size:15px; text-align:left;">In Word :<b><i> @ViewBag.InWordstotQty</i></b></label>
            </div>
            <br />
            <br />
            <br />
            <br />
            <div>
                <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:90%;border-collapse: collapse;" id="reportSign">
                    <tbody id="tbodyId">
                        <tr>

                            @foreach (var sig in signatory)
                            {
                                var FuncName = sig;
                                var tdwidth = 90 / sCount;
                                var tdgap = tdwidth / 4;

                                tdwidth = tdwidth - tdgap;

                            <td style="width:@tdwidth%; text-align:center; font-size:12px; border-top:1px solid ; border-left:hidden !important; border-bottom:hidden !important; border-right:hidden !important;"><label>@FuncName</label></td>

                                if (count < sCount)
                                {
                            <td style="width:@tdgap%; text-align:center; font-size:12px; border: hidden !important"><label></label></td>
                                }

                                count++;
                            }
                        </tr>
                    </tbody>
                </table>

            </div>
        </div>
    }
}
else if (ViewBag.CopyType == 2) //for Invoice
{
    for (int i = 0; i < ViewBag.CopyQty; i++)
    {
        sl = 0; count = 0;
        TotAmt = 0;
        TotDiscount = 0;
        if (i == 0) { CopyLabel = custC; }
        else if (i == 1) { CopyLabel = offC; }
        else { CopyLabel = godownC; }
        if (ViewBag.InvFormat == 1)
        {
            <div id="toReport" class="panel-body" style="margin: auto; text-align:center !important; width:800px; height:1200px; padding:60px">
                <div class="panel-title" style="text-align:right">
                    <text style="text-align:right !important; text-decoration: none; font-size:15px; border:2px solid black ; padding:5px">@CopyLabel</text>
                </div>
                <div class="panel-heading" style="text-align:center">
                    <div class="panel-title">
                        <label style="text-align:center !important; text-decoration: none; font-size:25px; font-weight:bold">@CompInfo.CompName</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Office: @CompanyAddress</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Phone: @CompInfo.Tel</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Email: @CompInfo.Email</label>

                    </div>
                    <br>
                    <br>
                    <div class="panel-title">
                        <text style="text-align:center !important; text-decoration: none; font-size:20px; border:1px solid black ; padding:5px">INVOICE</text>
                    </div>
                    <br />
                    <br />
                </div>
                <div class="row">
                    <div class="col-md-6" style="float:left; text-align:left ;width: 550px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.CustName}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Address</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SubAddress}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer Code</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.CustCode}</label></td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                    <div class="col-md-6" style="float:right;width:250px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice Date</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleDate.ToShortDateString()}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Ref No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.RefNo}</label></td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                </div>

                <div class="panel-body" style="text-align:center;">
                    <table cellpadding="5" cellspacing="1" border=1 frame=box rules=all style="width:800px">
                        <thead style="height:300px">
                            <tr>
                                <th class="ths" style="font-size:15px; text-align:center">SL</th>
                                <th class="ths" style="font-size:15px; text-align:center">Code</th>
                                <th class="ths" style="font-size:15px; text-align:center">Item Name</th>
                                <th class="ths" style="font-size:15px; text-align:center">Quantity</th>
                                <th class="ths" style="font-size:15px; text-align:center">Unit Price</th>
                                <th class="ths" style="font-size:15px; text-align:center">Amount</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyId">

                            @foreach (var item in Model)
                            {
                                sl += 1;
                            <tr>
                                <td class="" style="text-align:center; font-size:12px">
                                    @Html.DisplayFor(modelItem => sl)
                                </td>
                                <td class="" style="text-align:center; font-size:12px">
                                    @Html.DisplayFor(modelItem => item.ItemCode)
                                </td>
                                <td class="" style="text-align:left; font-size:12px">
                                    @Html.DisplayFor(modelItem => item.ItemName)
                                </td>
                                <td style="text-align:right; font-size:12px;">
                                    @Html.DisplayFor(modelItem => item.Qty)
                                </td>
                                <td style="text-align:right; font-size:12px;">
                                    @Html.DisplayFor(modelItem => item.UnitPrice)
                                </td>
                                <td style="text-align:right; font-size:12px;">
                                    @Html.DisplayFor(modelItem => item.Amount)
                                </td>
                            </tr>
                                TotAmt += Convert.ToDecimal(item.TotSaleAmt);
                                TotDiscount += Convert.ToDecimal(item.Discount);
                                AmtPayable = TotAmt - TotDiscount;
                            }
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Total Sale Amount :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotAmt</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Total Discount :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotDiscount</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Amount Payable :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@AmtPayable</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Amount Due :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@AmtPayable</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="float:left">
                    <label style="font-size:15px; text-align:left;">In Word :<b><i> @ViewBag.InWordsAmt</i></b></label>
                </div>
                <br />
                <br />
                <br />
                <br />
                <div>
                    <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:90%;border-collapse: collapse;" id="reportSign">
                        <tbody id="tbodyId">
                            <tr>

                                @foreach (var sig in signatory)
                                {
                                    var FuncName = sig;
                                    var tdwidth = 90 / sCount;
                                    var tdgap = tdwidth / 4;

                                    tdwidth = tdwidth - tdgap;

                                <td style="width:@tdwidth%; text-align:center; font-size:12px; border-top:1px solid ; border-left:hidden !important; border-bottom:hidden !important; border-right:hidden !important;"><label>@FuncName</label></td>

                                    if (count < sCount)
                                    {
                                <td style="width:@tdgap%; text-align:center; font-size:12px; border: hidden !important"><label></label></td>
                                    }

                                    count++;
                                }
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        }
        else if (ViewBag.InvFormat == 2)
        {
            <div id="toReport" class="panel-body" style="margin: auto; text-align:center !important; width:800px; height:1200px; padding:60px">
                <div class="panel-title" style="text-align:right">
                    <text style="text-align:right !important; text-decoration: none; font-size:15px; border:2px solid black ; padding:5px">@CopyLabel</text>
                </div>
                <div class="panel-heading" style="text-align:center">
                    <div class="panel-title">
                        <label style="text-align:center !important; text-decoration: none; font-size:25px; font-weight:bold">@CompInfo.CompName</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Office: @CompanyAddress</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Phone: @CompInfo.Tel</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Email: @CompInfo.Email</label>

                    </div>
                    <br>
                    <br>
                    <div class="panel-title">
                        <text style="text-align:center !important; text-decoration: none; font-size:20px; border:1px solid black ; padding:5px">INVOICE</text>
                    </div>
                    <br />
                </div>
                <div class="row">
                    <div class="col-md-6" style="float:left; text-align:left ;width: 550px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.CustName}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice Address</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SubAddress}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Delivery Address</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SubAddress}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Sale Reference</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.RefNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Phone No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.RefNo}</label></td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                    <div class="col-md-6" style="float:right;width:250px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice Date</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleDate.ToShortDateString()}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>PO No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.RefNo}</label></td>
                                </tr>

                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>PO Date</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleDate.ToShortDateString()}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:50%; text-align:left; font-size:12px; border: hidden !important"><label>VAT Challan No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.RefNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Delivery Date</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleDate.ToShortDateString()}</label></td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                </div>

                <div class="panel-body" style="text-align:center;">
                    <table cellpadding="5" cellspacing="1" border=1 frame=box rules=all style="width:800px">
                        <thead style="height:300px">
                            <tr>
                                <th style="width:100px; font-size:13px; text-align:center" rowspan="2">SL</th>
                                <th style="width:100px; font-size:13px; text-align:center" rowspan="2">Product Name</th>
                                <th style="width:120px; font-size:13px; text-align:center" rowspan="2">Pack Size</th>
                                <th style="width:120px; font-size:13px; text-align:center" colspan="3">Pack Unit</th>
                                <th style="width:100px; font-size:13px; text-align:center" rowspan="2">Total</th>
                            </tr>
                            <tr>
                                <th class="ths" style="font-size:15px; text-align:center">Qty</th>
                                <th class="ths" style="font-size:15px; text-align:center">Unit</th>
                                <th class="ths" style="font-size:15px; text-align:center">Rate</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyId">

                            @foreach (var item in Model)
                            {
                                sl += 1;
                                <tr>
                                    <td class="" style="text-align:center; font-size:12px">
                                        @Html.DisplayFor(modelItem => sl)
                                    </td>
                                    <td class="" style="text-align:left; font-size:12px">
                                        @Html.DisplayFor(modelItem => item.ItemName)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.Qty)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.UnitPrice)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.Amount)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.Amount)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.Amount)
                                    </td>
                                </tr>
                                TotAmt += Convert.ToDecimal(item.Amount);
                            }
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Total Sale Amount :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotAmt.ToString("N2")</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Grand Total :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotAmt.ToString("N2")</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="float:left">
                    <label style="font-size:15px; text-align:left;">In Word :<b><i> @ViewBag.InWordsAmt</i></b></label>
                </div>
                <br />
                <br />
                <br />
                <br />
                <div class="row">
                    <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:90%;border-collapse: collapse;" id="reportSign">
                        <tbody id="tbodyId">
                            <tr>

                                @foreach (var sig in signatory)
                                {
                                    var FuncName = sig;
                                    var tdwidth = 90 / sCount;
                                    var tdgap = tdwidth / 4;

                                    tdwidth = tdwidth - tdgap;

                                    <td style="width:@tdwidth%; text-align:center; font-size:12px; border-top:1px solid ; border-left:hidden !important; border-bottom:hidden !important; border-right:hidden !important;"><label>@FuncName</label></td>

                                    if (count < sCount)
                                    {
                                        <td style="width:@tdgap%; text-align:center; font-size:12px; border: hidden !important"><label></label></td>
                                    }

                                    count++;
                                }
                            </tr>
                        </tbody>
                    </table>
                </div>
                <br />
                <br />
                <div class="row">
                    <div class="col-md-12" style="width:250px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px;" colspan="2"><label>Received By</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; "><label>Name</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; "><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; "><label>Date</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; "><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; "><label>Mobile No</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; "><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12" style="width:250px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:100%; text-align:left; font-size:12px; border: hidden !important"><label>DeliverdBy</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:100%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:100%; text-align:left; font-size:12px; border: hidden !important "><label>Remarks</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:100%; text-align:left; font-size:12px; border: hidden !important">
                                        <textarea rows="5" cols="80">@if (mItem != null){@mItem.SaleNo}</textarea>
                                    </td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                </div>
            </div>
        }
        else if (ViewBag.InvFormat == 3)
        {

        }

    }
}
else // for Invoice and challan
{

    for (int i = 0; i < ViewBag.CopyQty; i++)
    {
        sl = 0;
        TotAmt = 0; count = 0;
        TotDiscount = 0;
        if (i == 0) { CopyLabel = custC; }
        else if (i == 1) { CopyLabel = offC; }
        else { CopyLabel = godownC; }
        if (ViewBag.InvFormat == 1)
        {
            <div id="toReport" class="panel-body" style="margin: auto; text-align:center !important; width:800px; height:1200px; padding:60px">
                <div class="panel-title" style="text-align:right">
                    <text style="text-align:right !important; text-decoration: none; font-size:15px; border:2px solid black ; padding:5px">@CopyLabel</text>
                </div>
                <div class="panel-heading" style="text-align:center">
                    <div class="panel-title">
                        <label style="text-align:center !important; text-decoration: none; font-size:25px; font-weight:bold">@CompInfo.CompName</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Office: @CompanyAddress</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Phone: @CompInfo.Tel</label><br>
                        <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Email: @CompInfo.Email</label>
                    </div>
                    <br>
                    <br>
                    <div class="panel-title">
                        <text style="text-align:center !important; text-decoration: none; font-size:20px; border:1px solid black ; padding:5px">INVOICE</text>
                    </div>
                    <br />
                    <br />
                </div>
                <div class="row">
                    <div class="col-md-6" style="float:left; text-align:left ;width: 550px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.CustName}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Address</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null)
                                    {@mItem.SubAddress}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer Code</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.CustCode}</label></td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                    <div class="col-md-6" style="float:right;width:250px">
                        <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                            <tbody id="tbodyId">
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice Date</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleDate.ToShortDateString()}</label></td>
                                </tr>
                                <tr>
                                    <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Ref No</label></td>
                                    <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                    <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.RefNo}</label></td>
                                </tr>
                            </tbody>
                        </table>&ensp;
                    </div>
                </div>

                <div class="panel-body" style="text-align:center;">
                    <table cellpadding="5" cellspacing="1" border=1 frame=box rules=all style="width:800px">
                        <thead style="height:300px">
                            <tr>
                                <th class="ths" style="font-size:15px; text-align:center">SL</th>
                                <th class="ths" style="font-size:15px; text-align:center">Code</th>
                                <th class="ths" style="font-size:15px; text-align:center">Item Name</th>
                                <th class="ths" style="font-size:15px; text-align:center">Quantity</th>
                                <th class="ths" style="font-size:15px; text-align:center">Unit Price</th>
                                <th class="ths" style="font-size:15px; text-align:center">Amount</th>
                            </tr>
                        </thead>
                        <tbody id="tbodyId">

                            @foreach (var item in Model)
                            {
                                sl += 1;
                                <tr>
                                    <td class="" style="text-align:center; font-size:12px">
                                        @Html.DisplayFor(modelItem => sl)
                                    </td>
                                    <td class="" style="text-align:center; font-size:12px">
                                        @Html.DisplayFor(modelItem => item.ItemCode)
                                    </td>
                                    <td class="" style="text-align:left; font-size:12px">
                                        @Html.DisplayFor(modelItem => item.ItemName)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.Qty)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.UnitPrice)
                                    </td>
                                    <td style="text-align:right; font-size:12px;">
                                        @Html.DisplayFor(modelItem => item.Amount)
                                    </td>
                                </tr>
                                TotAmt += Convert.ToDecimal(item.TotSaleAmt);
                                TotDiscount += Convert.ToDecimal(item.Discount);
                                AmtPayable = TotAmt - TotDiscount;
                            }
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Total Sale Amount :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotAmt</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Total Discount :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotDiscount</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Amount Payable :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@AmtPayable</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                            <tr>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right"></td>
                                <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Amount Due :</td>
                                <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@AmtPayable</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div style="float:left">
                    <label style="font-size:15px; text-align:left;">In Word :<b><i> @ViewBag.InWordsAmt</i></b></label>
                </div>
                <br />
                <br />
                <br />
                <br />
                <div>
                    <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:90%;border-collapse: collapse;" id="reportSign">
                        <tbody id="tbodyId">
                            <tr>

                                @foreach (var sig in signatory)
                                {
                                    var FuncName = sig;
                                    var tdwidth = 90 / sCount;
                                    var tdgap = tdwidth / 4;

                                    tdwidth = tdwidth - tdgap;

                                    <td style="width:@tdwidth%; text-align:center; font-size:12px; border-top:1px solid ; border-left:hidden !important; border-bottom:hidden !important; border-right:hidden !important;"><label>@FuncName</label></td>

                                    if (count < sCount)
                                    {
                                        <td style="width:@tdgap%; text-align:center; font-size:12px; border: hidden !important"><label></label></td>
                                    }

                                    count++;
                                }
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        }
        else if (ViewBag.InvFormat == 2)
        {

        }
        else if (ViewBag.InvFormat == 3)
        {

        }

    }

    for (int i = 0; i < ViewBag.CopyQty; i++)
    {
        sl = 0; TotQty = 0; count = 0;
        if (i == 0) { CopyLabel = custC; }
        else if (i == 1) { CopyLabel = offC; }
        else { CopyLabel = godownC; }

        <div id="toReport" class="panel-body" style="margin: auto; text-align:center !important; width:800px; height:1200px; padding:60px">
            <div class="panel-title" style="text-align:right">
                <text style="text-align:right !important; text-decoration: none; font-size:15px; border:2px solid black ; padding:5px">@CopyLabel</text>
            </div>
            <div class="panel-heading" style="text-align:center">
                <div class="panel-title">
                    <label style="text-align:center !important; text-decoration: none; font-size:25px; font-weight:bold">@CompInfo.CompName</label><br>
                    <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Office: @CompanyAddress</label><br>
                    <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Phone: @CompInfo.Tel</label><br>
                    <label style="text-align:center !important; text-decoration: none; font-size:23px; font-weight:normal">Email: @CompInfo.Email</label>
                </div>
                <br>
                <br>
                <div class="panel-title">
                    <text style="text-align:center !important; text-decoration: none; font-size:20px; border:1px solid black ; padding:5px">DELIVERY CHALLAN</text>
                </div>
                <br />
                <br />
            </div>
            <div class="row">
                <div class="col-md-6" style="float:left; text-align:left ;width: 550px">
                    <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                        <tbody id="tbodyId">
                            <tr>
                                <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.CustName}</label></td>
                            </tr>
                            <tr>
                                <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Address</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null)
                                {@mItem.SubAddress} </label></td>
                            </tr>
                            <tr>
                                <td style="width:20%; text-align:left; font-size:12px; border: hidden !important"><label>Customer Code</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if(mItem != null){@mItem.CustCode}</label></td>
                            </tr>
                        </tbody>
                    </table>&ensp;
                </div>
                <div class="col-md-6" style="float:right;width:250px">
                    <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:100%;border-collapse: collapse;">
                        <tbody id="tbodyId">
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Challan No</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.IssueNo}</label></td>
                            </tr>
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Challan Date</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@Convert.ToDateTime(mItem.IssueDate).ToShortDateString()}</label></td>
                            </tr>
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Location</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>

                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.LocCode}</label></td>
                            </tr>
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice No</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleNo}</label></td>
                            </tr>
                            <tr>
                                <td style="width:40%; text-align:left; font-size:12px; border: hidden !important"><label>Invoice Date</label></td>
                                <td style="width:1%; text-align:right; font-size:12px; border: hidden !important"><label>:</label></td>
                                <td style="width:80%; text-align:left; font-size:12px; border: hidden !important"><label>@if (mItem != null){@mItem.SaleDate.ToShortDateString()}</label></td>
                            </tr>
                        </tbody>
                    </table>&ensp;
                </div>
            </div>

            <div class="panel-body" style="text-align:center;">
                <table cellpadding="5" cellspacing="1" border=1 frame=box rules=all style="width:800px">
                    <thead style="height:300px">
                        <tr>
                            <th class="ths" style="font-size:15px; text-align:center">SL</th>
                            <th class="ths" style="font-size:15px; text-align:center">Code</th>
                            <th class="ths" style="font-size:15px; text-align:center">Item Name</th>
                            <th class="ths" style="font-size:15px; text-align:center">Quantity</th>
                        </tr>
                    </thead>
                    <tbody id="tbodyId">

                        @foreach (var item in Model)
                        {
                            sl += 1;
                            <tr>
                                <td class="" style="text-align:center; font-size:12px">
                                    @Html.DisplayFor(modelItem => sl)
                                </td>
                                <td class="" style="text-align:center; font-size:12px">
                                    @Html.DisplayFor(modelItem => item.ItemCode)
                                </td>
                                <td class="" style="text-align:left; font-size:12px">
                                    @Html.DisplayFor(modelItem => item.ItemName)
                                </td>
                                <td style="text-align:right; font-size:12px;">
                                    @Html.DisplayFor(modelItem => item.Qty)
                                </td>
                            </tr>
                            TotQty += Convert.ToDecimal(item.Qty);
                        }
                        <tr>
                            <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                            <td style="border-right: hidden !important; border-left: hidden !important;border-bottom: hidden !important;"></td>
                            <td style="border-right: hidden !important; border-bottom: hidden !important; text-align:right">Total :</td>
                            <td class="tds" style="text-align: right; font-size: 12px; border-top: 1px solid;border-bottom: hidden !important;border-right: hidden !important;"><b>@TotQty</b><hr style="margin-bottom: 3px !important; margin-top: 0 !important" /></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div style="float:left">
                <label style="font-size:15px; text-align:left;">In Word :<b><i> @ViewBag.InWordstotQty</i></b></label>
            </div>
            <br />
            <br />
            <br />
            <br />
            <div>
                <table cellpadding="5" cellspacing="1" border="0" align="center" frame=box rules=all style="width:90%;border-collapse: collapse;" id="reportSign">
                    <tbody id="tbodyId">
                        <tr>

                            @foreach (var sig in signatory)
                            {
                                var FuncName = sig;
                                var tdwidth = 90 / sCount;
                                var tdgap = tdwidth / 4;

                                tdwidth = tdwidth - tdgap;

                                <td style="width:@tdwidth%; text-align:center; font-size:12px; border-top:1px solid ; border-left:hidden !important; border-bottom:hidden !important; border-right:hidden !important;"><label>@FuncName</label></td>

                                if (count < sCount)
                                {
                                    <td style="width:@tdgap%; text-align:center; font-size:12px; border: hidden !important"><label></label></td>
                                }

                                count++;
                            }
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    }
}